<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-564CXCJ8');</script>
<!-- End Google Tag Manager -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSON Tree Viewer | JSONLab</title>
<meta name="description" content="Interactive JSON tree viewer with collapsible nodes. Visualize JSON structure easily. Free online tool, no signup required.">
<link rel="canonical" href="https://jsonlab.xyz/tools/tree/">
<link rel="stylesheet" href="/src/css/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/json-formatter-js/dist/json-formatter.min.css">
<script src="https://cdn.jsdelivr.net/npm/json-formatter-js"></script>
</head>
<body class="flex flex-col h-screen">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-564CXCJ8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<header class="bg-white dark:bg-gray-800 shadow-sm">
<nav class="max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
<a href="/" class="flex items-center gap-2 font-bold">
<svg class="w-6 h-6 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h18v18H3V3zm16 16V5H5v14h14zM7 7h2v2H7V7zm0 4h2v2H7v-2zm0 4h2v2H7v-2zm4-8h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6v-2z"/></svg>
JSONLab
</a>
<button id="theme-toggle" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
<svg id="theme-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"></svg>
</button>
</nav>
</header>
<main class="flex-1 flex flex-col overflow-hidden">
<div class="bg-blue-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700 px-4 py-3">
<h1 class="text-2xl font-bold mb-2">JSON Tree Viewer</h1>
<p class="text-sm text-gray-600 dark:text-gray-300">Interactive collapsible tree view for JSON data. Explore complex JSON structures with ease.</p>
</div>
<div class="bg-white dark:bg-gray-800 border-b px-4 py-2">
<button id="view-btn" class="px-4 py-2 bg-blue-600 text-white rounded">View Tree</button>
<label class="ml-4 text-sm">
  <input type="checkbox" id="virtualized" class="mr-1"> Virtualized (for large JSON)
</label>
<span id="node-count" class="ml-4 text-sm text-gray-500"></span>
</div>
<div class="flex-1 flex flex-col lg:flex-row overflow-hidden">
<div class="flex-1 flex flex-col border-r">
<div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium">Input</div>
<textarea id="input" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 resize-none focus:outline-none" placeholder="Paste JSON..."></textarea>
</div>
<div class="flex-1 flex flex-col">
<div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium">Tree View</div>
<div id="tree" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 overflow-auto"></div>
</div>
</div>
</main>
<script type="module" src="/src/js/theme.js"></script>
<script>
class VirtualizedTreeRenderer {
  constructor(container, data, maxVisible = 100) {
    this.container = container;
    this.data = data;
    this.maxVisible = maxVisible;
    this.flatNodes = [];
    this.visibleNodes = [];
    this.scrollTop = 0;
    this.nodeHeight = 24;
    this.expandedNodes = new Set();
    
    this.flatten(data, '', 0);
    this.render();
  }
  
  flatten(obj, path, level) {
    if (typeof obj === 'object' && obj !== null) {
      if (Array.isArray(obj)) {
        this.flatNodes.push({ type: 'array', path, level, length: obj.length, expanded: false });
        if (this.expandedNodes.has(path)) {
          obj.forEach((item, i) => {
            this.flatten(item, `${path}[${i}]`, level + 1);
          });
        }
      } else {
        const keys = Object.keys(obj);
        this.flatNodes.push({ type: 'object', path, level, keys: keys.length, expanded: false });
        if (this.expandedNodes.has(path)) {
          keys.forEach(key => {
            this.flatten(obj[key], path ? `${path}.${key}` : key, level + 1);
          });
        }
      }
    } else {
      this.flatNodes.push({ type: 'value', path, level, value: obj });
    }
  }
  
  render() {
    const startIndex = Math.floor(this.scrollTop / this.nodeHeight);
    const endIndex = Math.min(startIndex + this.maxVisible, this.flatNodes.length);
    
    let html = `<div style="height: ${this.flatNodes.length * this.nodeHeight}px; position: relative;">`;
    
    for (let i = startIndex; i < endIndex; i++) {
      const node = this.flatNodes[i];
      const top = i * this.nodeHeight;
      const indent = node.level * 20;
      
      html += `<div style="position: absolute; top: ${top}px; left: ${indent}px; height: ${this.nodeHeight}px; line-height: ${this.nodeHeight}px;">`;
      
      if (node.type === 'object') {
        html += `<span class="cursor-pointer" onclick="toggleNode('${node.path}')">üìÅ {${node.keys} keys}</span>`;
      } else if (node.type === 'array') {
        html += `<span class="cursor-pointer" onclick="toggleNode('${node.path}')">üìÇ [${node.length} items]</span>`;
      } else {
        html += `<span class="text-blue-600">${JSON.stringify(node.value)}</span>`;
      }
      
      html += '</div>';
    }
    
    html += '</div>';
    this.container.innerHTML = html;
  }
}

let treeRenderer;

function toggleNode(path) {
  if (treeRenderer.expandedNodes.has(path)) {
    treeRenderer.expandedNodes.delete(path);
  } else {
    treeRenderer.expandedNodes.add(path);
  }
  treeRenderer.flatNodes = [];
  treeRenderer.flatten(treeRenderer.data, '', 0);
  treeRenderer.render();
}

function countNodes(obj) {
  let count = 0;
  function traverse(item) {
    count++;
    if (typeof item === 'object' && item !== null) {
      Object.values(item).forEach(traverse);
    }
  }
  traverse(obj);
  return count;
}

document.getElementById('view-btn').onclick = () => {
  try {
    const obj = JSON.parse(document.getElementById('input').value);
    const nodeCount = countNodes(obj);
    document.getElementById('node-count').textContent = `${nodeCount} nodes`;
    
    const container = document.getElementById('tree');
    const useVirtualized = document.getElementById('virtualized').checked;
    
    if (useVirtualized || nodeCount > 1000) {
      treeRenderer = new VirtualizedTreeRenderer(container, obj);
    } else {
      const formatter = new JSONFormatter(obj, 2);
      container.innerHTML = '';
      container.appendChild(formatter.render());
    }
  } catch(e) {
    document.getElementById('tree').innerHTML = '<div class="text-red-600">Invalid JSON: ' + e.message + '</div>';
  }
};
</script>
</body>
</html>
