<!DOCTYPE html>
<html lang="en">
<head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-564CXCJ8');</script>
<!-- End Google Tag Manager -->
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://www.googletagmanager.com https://www.google-analytics.com">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-Frame-Options" content="DENY">
<meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
<title>JSON to CSV - Convert JSON to CSV Online | JSONLab</title>
<meta name="description" content="Convert JSON arrays to CSV format instantly. Free online JSON to CSV converter with download option. No signup required, works offline.">
<link rel="stylesheet" href="/src/css/styles.css">
</head>
<body class="flex flex-col h-screen">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-564CXCJ8"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<header class="bg-white dark:bg-gray-800 shadow-sm">
<nav class="max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
<a href="/" class="flex items-center gap-2 font-bold">
<svg class="w-6 h-6 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h18v18H3V3zm16 16V5H5v14h14zM7 7h2v2H7V7zm0 4h2v2H7v-2zm0 4h2v2H7v-2zm4-8h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6v-2z"/></svg>
JSONLab
</a>
<button id="theme-toggle" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
<svg id="theme-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"></svg>
</button>
</nav>
</header>
<main class="flex-1 flex flex-col overflow-hidden">
<!-- Content Section -->
<div class="bg-gray-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700 px-4 py-3">
<h1 class="text-2xl font-bold mb-2">JSON to CSV Converter</h1>
<p class="text-sm text-gray-700 dark:text-gray-300 max-w-4xl">
Convert JSON arrays to CSV format for spreadsheet applications like Excel, Google Sheets, or data analysis tools. Simply paste your JSON array and get properly formatted CSV output with headers automatically extracted from your data structure.
</p>
</div>

<div class="bg-white dark:bg-gray-800 border-b px-4 py-2">
<button id="convert-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Convert</button>
<button id="copy-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded ml-2 hover:bg-gray-300">Copy</button>
<button id="clear-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded ml-2 hover:bg-gray-300">Clear</button>
</div>
<div class="flex-1 flex flex-col lg:flex-row overflow-hidden">
<div class="flex-1 flex flex-col border-r border-gray-200 dark:border-gray-700">
<div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium">JSON Input</div>
<textarea id="input" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 code-editor resize-none focus:outline-none text-sm" placeholder='Paste JSON array here...&#10;[{"name":"John","age":30},{"name":"Jane","age":25}]' spellcheck="false"></textarea>
</div>
<div class="flex-1 flex flex-col">
<div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium">CSV Output</div>
<pre id="output" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 code-editor overflow-auto text-sm"></pre>
</div>
</div>
</main>
<div id="toast" class="fixed bottom-4 right-4 px-4 py-2 bg-gray-900 text-white rounded shadow-lg hidden">Copied!</div>
<script type="module" src="/src/js/theme.js"></script>
<script>
// Theme toggle
const moonIcon = '<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>';
const theme = localStorage.getItem('theme') || 'light';
document.documentElement.className = theme;
document.getElementById('theme-icon').innerHTML = moonIcon;

document.getElementById('theme-toggle').addEventListener('click', () => {
  const newTheme = document.documentElement.className === 'dark' ? 'light' : 'dark';
  document.documentElement.className = newTheme;
  localStorage.setItem('theme', newTheme);
});

function jsonToCsv(json) {
  if (!json.trim()) throw new Error('Please enter JSON data');
  
  const arr = JSON.parse(json);
  
  if (!Array.isArray(arr)) {
    throw new Error('Input must be an array of objects. Example: [{"name":"John","age":30}]');
  }
  
  if (arr.length === 0) {
    throw new Error('Array cannot be empty');
  }
  
  // Handle array of primitives
  if (typeof arr[0] !== 'object' || arr[0] === null) {
    return 'value\n' + arr.map(item => item || '').join('\n');
  }
  
  const headers = Object.keys(arr[0]);
  const csv = [headers.join(',')];
  
  arr.forEach(obj => {
    const row = headers.map(h => {
      const value = obj[h];
      if (value === null || value === undefined) return '';
      if (typeof value === 'string' && value.includes(',')) {
        return `"${value.replace(/"/g, '""')}"`;
      }
      return value;
    });
    csv.push(row.join(','));
  });
  
  return csv.join('\n');
}

document.getElementById('convert-btn').onclick = () => {
  try {
    const csv = jsonToCsv(document.getElementById('input').value);
    document.getElementById('output').textContent = csv;
  } catch(e) {
    document.getElementById('output').textContent = 'Error: ' + e.message;
  }
};

document.getElementById('copy-btn').onclick = async () => {
  await navigator.clipboard.writeText(document.getElementById('output').textContent);
  const toast = document.getElementById('toast');
  toast.classList.remove('hidden');
  setTimeout(() => toast.classList.add('hidden'), 2000);
};

document.getElementById('clear-btn').onclick = () => {
  document.getElementById('input').value = '';
  document.getElementById('output').textContent = '';
};
</script>
</body>
</html>
