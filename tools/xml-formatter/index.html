<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XML Formatter - Format XML Online Free | JSONLab</title>
  <meta name="description" content="Free XML formatter online. Format, beautify and validate XML instantly. No signup required. Fast, secure, works offline.">
  <link rel="canonical" href="https://jsonlab.xyz/tools/xml-formatter/">
  <meta property="og:title" content="XML Formatter - Fast & Private">
  <meta property="og:description" content="Format and beautify XML online. 100% client-side processing.">
  <meta property="og:image" content="https://jsonlab.xyz/thumbnail.jpg">
  <link rel="stylesheet" href="/src/css/styles.css">
</head>
<body class="flex flex-col h-screen">
  <header class="bg-white dark:bg-gray-800 shadow-sm">
    <nav class="max-w-7xl mx-auto px-4 h-14 flex items-center justify-between">
      <a href="/" class="flex items-center gap-2 font-bold">
        <svg class="w-6 h-6 text-primary" fill="currentColor" viewBox="0 0 24 24"><path d="M3 3h18v18H3V3zm16 16V5H5v14h14zM7 7h2v2H7V7zm0 4h2v2H7v-2zm0 4h2v2H7v-2zm4-8h6v2h-6V7zm0 4h6v2h-6v-2zm0 4h6v2h-6v-2z"/></svg>
        JSONLab
      </a>
      <button id="theme-toggle" class="p-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700">
        <svg id="theme-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"></svg>
      </button>
    </nav>
  </header>
  
  <main class="flex-1 flex flex-col overflow-hidden">
    <div class="bg-blue-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700 px-4 py-3">
      <h1 class="text-2xl font-bold mb-2">XML Formatter - Format XML Online</h1>
      <p class="text-sm text-gray-600 dark:text-gray-300">Format and beautify XML data instantly. Clean up messy XML, validate syntax, and make your data readable. Privacy-first tool that works entirely in your browser.</p>
    </div>
    
    <div class="bg-white dark:bg-gray-800 border-b px-4 py-2">
      <div class="flex gap-2 items-center flex-wrap">
        <button id="format-btn" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Format</button>
        <button id="minify-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300">Minify</button>
        <button id="copy-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300">Copy</button>
        <button id="download-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300">Download</button>
        <label class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 cursor-pointer">
          Upload
          <input type="file" id="upload-btn" accept=".xml,.txt" class="hidden">
        </label>
        <button id="clear-btn" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300">Clear</button>
        <select id="indent-select" class="px-3 py-2 bg-gray-200 dark:bg-gray-700 rounded text-sm">
          <option value="2">2 spaces</option>
          <option value="4">4 spaces</option>
          <option value="tab">Tab</option>
        </select>
      </div>
    </div>
    
    <div class="flex-1 flex flex-col lg:flex-row overflow-hidden">
      <div class="flex-1 flex flex-col border-r">
        <div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium flex justify-between">
          <span>XML Input</span>
          <span id="input-stats" class="text-xs text-gray-500"></span>
        </div>
        <textarea id="input" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 resize-none focus:outline-none font-mono text-sm" placeholder='<root><item>value</item></root>'></textarea>
      </div>
      <div class="flex-1 flex flex-col">
        <div class="px-4 py-2 bg-gray-50 dark:bg-gray-900 border-b text-sm font-medium flex justify-between">
          <span>Formatted XML</span>
          <div class="flex gap-3">
            <span id="output-stats" class="text-xs text-gray-500"></span>
            <span id="status" class="text-xs"></span>
          </div>
        </div>
        <div id="output" class="flex-1 p-4 bg-white dark:bg-gray-800 dark:text-gray-200 overflow-auto font-mono text-sm whitespace-pre"></div>
      </div>
    </div>
  </main>

  <script>
    function formatXML(xml, indent) {
      const PADDING = indent === 'tab' ? '\t' : ' '.repeat(parseInt(indent));
      const reg = /(>)(<)(\/*)/g;
      xml = xml.replace(reg, '$1\r\n$2$3');
      let pad = 0;
      return xml.split('\r\n').map(line => {
        let indent = 0;
        if (line.match(/.+<\/\w[^>]*>$/)) {
          indent = 0;
        } else if (line.match(/^<\/\w/) && pad !== 0) {
          pad -= 1;
        } else if (line.match(/^<\w[^>]*[^\/]>.*$/)) {
          indent = 1;
        } else {
          indent = 0;
        }
        const padding = PADDING.repeat(pad);
        pad += indent;
        return padding + line;
      }).join('\r\n');
    }

    function minifyXML(xml) {
      return xml.replace(/>\s+</g, '><').replace(/\s+/g, ' ').trim();
    }

    function validateXML(xml) {
      try {
        const parser = new DOMParser();
        const doc = parser.parseFromString(xml, 'text/xml');
        const errors = doc.getElementsByTagName('parsererror');
        return errors.length === 0;
      } catch (e) {
        return false;
      }
    }

    const updateStats = () => {
      const text = document.getElementById('input').value;
      const chars = text.length;
      const lines = text ? text.split('\n').length : 0;
      document.getElementById('input-stats').textContent = `${chars} chars, ${lines} lines`;
      
      const outText = document.getElementById('output').textContent;
      const outChars = outText.length;
      const outLines = outText ? outText.split('\n').length : 0;
      document.getElementById('output-stats').textContent = outChars ? `${outChars} chars, ${outLines} lines` : '';
    };

    document.getElementById('format-btn').addEventListener('click', () => {
      const input = document.getElementById('input').value;
      const indent = document.getElementById('indent-select').value;
      
      if (validateXML(input)) {
        const formatted = formatXML(input, indent);
        document.getElementById('output').textContent = formatted;
        document.getElementById('status').textContent = '✓ Valid XML';
        document.getElementById('status').className = 'text-xs text-green-600 dark:text-green-400';
      } else {
        document.getElementById('output').textContent = '';
        document.getElementById('status').textContent = '✗ Invalid XML';
        document.getElementById('status').className = 'text-xs text-red-600 dark:text-red-400';
      }
      updateStats();
    });

    document.getElementById('minify-btn').addEventListener('click', () => {
      const input = document.getElementById('input').value;
      
      if (validateXML(input)) {
        const minified = minifyXML(input);
        document.getElementById('output').textContent = minified;
        document.getElementById('status').textContent = '✓ Valid XML';
        document.getElementById('status').className = 'text-xs text-green-600 dark:text-green-400';
      } else {
        document.getElementById('output').textContent = '';
        document.getElementById('status').textContent = '✗ Invalid XML';
        document.getElementById('status').className = 'text-xs text-red-600 dark:text-red-400';
      }
      updateStats();
    });

    document.getElementById('copy-btn').addEventListener('click', () => {
      const output = document.getElementById('output').textContent;
      navigator.clipboard.writeText(output);
    });

    document.getElementById('download-btn').addEventListener('click', () => {
      const text = document.getElementById('output').textContent || document.getElementById('input').value;
      if (!text) return;
      const blob = new Blob([text], { type: 'application/xml' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'formatted.xml';
      a.click();
      URL.revokeObjectURL(url);
    });

    document.getElementById('upload-btn').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById('input').value = e.target.result;
          updateStats();
        };
        reader.readAsText(file);
      }
    });

    document.getElementById('clear-btn').addEventListener('click', () => {
      document.getElementById('input').value = '';
      document.getElementById('output').textContent = '';
      document.getElementById('status').textContent = '';
      updateStats();
    });

    document.getElementById('input').addEventListener('input', updateStats);

    // Sample XML
    document.getElementById('input').value = `<bookstore><book id="1"><title>XML Guide</title><author>John Doe</author><price>29.99</price></book><book id="2"><title>Web Development</title><author>Jane Smith</author><price>39.99</price></book></bookstore>`;

    // Theme toggle
    const theme = localStorage.getItem('theme') || 'light';
    document.documentElement.className = theme;
    const icons = {
      light: '<path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/>',
      dark: '<path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>'
    };
    document.getElementById('theme-icon').innerHTML = icons[theme];
    
    document.getElementById('theme-toggle').addEventListener('click', () => {
      const currentTheme = localStorage.getItem('theme') || 'light';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.documentElement.className = newTheme;
      localStorage.setItem('theme', newTheme);
      document.getElementById('theme-icon').innerHTML = icons[newTheme];
    });

    updateStats();
  </script>
</body>
</html>